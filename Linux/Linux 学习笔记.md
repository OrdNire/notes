# Linux 学习笔记



### Linux 目录结构

> LInux一切皆文件

**/** 根目录

**/bin [常用]** 存放经常使用的命令

**/sbin** (/user/bin /user/local/sbin) s->super 存放系统管理员使用的系统管理程序

**/home [常用]** 存放普通用户的主目录，一个用户对应一个文件夹

**/root [常用]** 系统管理员主目录

**/lib** 基本动态连接共享库，类似windows DDL

**/lost+found** 一般为空，非法关机存放一些文件

**/etc [常用]** 配置文件

**/usr [常用]** 应用程序和文件放入该目录

**/boot [常用]** 启动linux核心文件

**/proc [不可修改]** 内存映射

**/src [不可修改]** service，存放服务启动需要的数据

**/sys [不可修改]** 新版本内核

**/tmp** 临时文件

**/dev** 所有的硬件（文件表示）

**/media [常用]** U盘，光驱..

**/mnt [常用]** 让用户临时挂载其它文件系统，外部存储挂载在/mnt/上，进入就可以查看

**/opt** 安装软件包

**/usr/local [常用]** 额外安装软件安装目录

**/var [常用]** 经常修改的文件，如日志



### vim快速入门

**命令模式：**

:wq 保存退出  

:q 退出 

:q! 强制退出

**常用快捷键**

yy	拷贝当前行

5yy	拷贝当前行向下的5行

p	粘贴

dd	删除当前行，前面加数字表示删除当前向下 x 行

命令行 /关键字	查找关键字，按 n 下一个

:set nu	设置文件行号

:set nonu	取消文件行号

gg	跳转文件首行

G	跳转文件末尾

u	撤销

x shift+g	直接定位到 x 行



### Linux 关机和重启

shutdown -h now	立即关机

shutdown -h 1	一分钟后关机(shutdown 命令默认)

shudown -r now	立即重启

halt	同上

reboot	立即重启

**sync**	讲内存写磁盘

**关机和重启前建议先 sync 后 shutdown**



### **用户登录和注销**

**建议非root登录**

su - 用户名	切换用户

logout	注销用户，但无法在图像界面级别下使用，只能在运行级别3，返回上一级用户

**Linux 运行级别查看该篇博客 https://www.linuxidc.com/Linux/2018-07/153129.htm**

运行级别命令：

init [0,1,2,3,4,5] 切换运行级别

systemctl get-default 获取默认运行级别

systemctl set-default ... 设置默认级别



### 用户管理

**添加用户**

**useradd**	添加用户
创建用户后会在 /home 下创建一个用户名的文件夹

useradd -d 目录	可以给创建的用户指定home目录

**passwd 用户名**	给指定用户名设置密码，如果用户名不写则默认当前用户

pwd	显示当前用户所在的目录

**删除用户**

**userdel 用户名**	删除指定用户名，**家目录保留**

**userdel -r 用户名**	删除用户，同时删除家目录 **！慎重删除，可能存在资料，建议保留**

**查询用户信息**

id 用户名	用户信息

who am i	我是谁，显示第一次登录的用户信息

**用户组**

用户具有某一共性可以分到特定的用户组（类似于角色）
例如：我可以对某一用户授予某一权限，也可以直接授予某一组，该组中的所有用户都具有该权限

**groupadd 组名**	添加组

groupdel 组名	删除组

useradd -g 用户组  用户名	创建用户时直接指定到特定组

> 之前如果创建用户没有指定组，默认时创建了一个跟用户名同名的组，且将其加入

**usermod -g 用户组 用户名**	讲某用户放入到另外指定的组

**相关文件**

/etc/passwd	用户配置文件，记录用户的信息

/etc/shadow	口令配置文件

/etc/group	组的配置文件



### 帮助指令

**man [命令或配置文件]**	获得帮助信息
例如：man ls  ls 的命令的帮助文档



### 文件目录指令

pwd (present work directory)	列出当前所在目录的**绝对路劲**

ls [选项] [目录或文件]	-a 显示所有，-l 以列表

cd	切换，cd ~ 回到家目录 cd / 回到根目录

mkdir [选项]	创建目录，-p 创建多级目录

rmdir	删除目录，如果有内容，可以采用强制删除
rm -rf	强制删除 **慎用慎用！**

touch  文件名	创建空文件

**cp [选项] source dest**	拷贝文件，从source -> dest，-r 选项为递归拷贝整个文件夹，如果dest有文件则会提示是否会覆盖，可以选择 \cp 来取消提醒

rm [选项]	删除文件或目录，-r 递归删除整个文件，-f强制删除

mv	移动文件或目录或**重命名**，**如果在同一目录下移动文件则是重命名**，也可以dest为目录加文件名则为移动并重命名，否则移动

cat	查看文件内容，-n 显示行号

cat -n [文件] | more //进行交互	| 管道，即将上一个指令的结果交给下一个指令

**more**	基于vi编辑器的文本过滤器，可以全屏查看文件内容，并且可以翻页等操作，例如:	enter 下一行，space 下一页...

**less**	用于分屏查看文件内容，它的功能与more指令类似，支持各种显示终端，对于显示大型文件具有较高效率

echo [选项] [输出内容]	输出指令 

head 文件	查看文件头10行内容，-n x 查看文件头 x 行内容 

**tail 文件**	显示文件末尾10行内容，**-f 可以实时追踪该文档**

**\> 或者 \>>** 文件	输出重定向，可以将内容写入某文件，例如：ls -a \> hello.txt，列出来的内容输入到hello.txt，其中 \> 为覆盖写，\>> 为追加

**ln**	软链接，类似windows快捷方式

ln -s [源文件或目录]  [软链接]	创建一个软链接

history	查看所有历史命令，history 10 查看最近10条命令，!5 执行曾经执行过的指令



### 时间日期

date	显示当前日期，+%Y 显示当前年份，+%m 显示当前月份，+%d 显示当前是哪一天，"+%Y-%m-%d %H:%M:%S"  显示年月日时分秒

date -s 字符串时间	设置当前时间

cal	显示本月日历，cal x 查看第 x 的年份



### 查找

find [搜索范围] [选项]	递归遍历子目录搜素文件或目录，-name 按文件名，-user  按用户，-size +n，大于n的文件

locate	快速定位文件路径，不是遍历，而是建立数据库，快速查找，**需要定时更新！**，**第一次使用需要 updatedb 创建locate数据库，以后可以利用这个更新**

which 指令	可以查看某个指令的目录

grep [选项] 查找内容 源文件	过滤查找，对于一段文本查找内容，通常和**管道相结合**数使用，-n 显示匹配行及行号，-i 忽略大小写
例如:cat hello.txt | grep -n "yes"，查看hello.txt中yes出现的行



### 压缩和解压

gzip/gunzip	gzip 压缩文件，gunzip 解压文件（其中只能压缩为.gz文件和解压.gz文件）

**zip/unzip [选项] [压缩后文件名] [源]**	用于压缩或解压**文件或文件夹**，在项目中有用，处理各式为.zip，zip -r 选项为递归压缩，即压缩目录，unzip -d [目录] 解压后文件的存放目录
例如: zip -r myhome.zip /home/	将home及其下的所有文件和文件夹压缩进去

**tar [选项] XXX.tar.gz 打包的内容**	打包目录，压缩后的文件为XXX.tar.gz，也可以用其做解压，通过选项来操作

| 选项 | 功能               |
| ---- | ------------------ |
| -c   | 产生.tar打包文件   |
| -v   | 显示详细信息       |
| -f   | 指定压缩后的文件名 |
| -z   | 打包同时压缩       |
| -x   | 解包.tar文件       |

例如：
tar -zcvf pc.tar.gz xxx xx 将 xxx xx 压缩为 pc.tar.gz

tar -zcvf myhome.tar.gz /home/	将home下所有文件压缩 

tar -zxvf xxx	解压 xxx 文件到当前目录

tar -zxvf xxx -C aaa	将xxx解压到 aaa 目录



### Linux组

> 每个用户必须属于一个组

Linux 文件有**所有者，所在组，非所在组外的其它组**
A 用户创建的 a.txt 的所有者为 A，所在组为 A 所在的组
即，**A 创建文件时，默认文件的组为A所在的组**

chown 用户名 文件名 (change owner)	修改文件所有者

chgrp 组名 文件名	修改文件所在的组

**其他组**：除文件所有者以及所在组的用户外，系统其它用户所在的组都是文件的其他组

usermod -g 新组名 用户名	修改用户所在的组
usermod -d 目录名 用户名	修改用户的默认登录目录，**目录必须保证用户有权限进入新的文件，否则无法登录**

**ls -l的目录意思**

![ll](D:\个人资料\Notes\Linux\img\ll.png)

0-9 位的说明：

1. 第 0 位确定文件类型（-, d, l, c, b）
   1. l 链接
   2. d 目录
   3. c 字符设备文件：鼠标，键盘
   4. 块设备，如硬盘
2. 1 - 3位  文件所有者所拥有的权限
3. 4-6 文件所属组的用户所拥有的权限
4. 7-9 其他组用户的权限

其中， [r] 为(read)，[x] (write)， [x] (执行)，**也可以用数字表示权限：r = 4, w = 2, x = 1，所以rwx权限为 7**



**修改权限 chmod**

第一种方式：+ 、-、= 变更权限

u 所有者， g 所在组，o 其它人， a 所有人

1. chmod u=rwx,g=rx,o=x(不能有空格) 文件/目录名	直接给特定权限
2. chmod o+w 文件/目录名   加上某权限
3. chmod a-x 文件/目录名     去掉某权限

第二种方式：通过数字改变

**r = 4, w = 2, x = 1**

例如：chmod 751 文件/目录名	给所有者7权限(r + w + x)，所在组5权限(r + x)，其它组1权限(x)



**修改文件所有者 chown**

chown [newowner] 文件/目录	改变所有者

chown [newowner]:[newgroup] 文件/目录	改变所有者和所在组

-R	如果是目录，则使其所有子文件或目录递归生效



**修改文件或目录所在组 chgrp**

chgrp [newgroup] 文件/目录	[改变所在组]

-R 递归修改其下所有的组



### crond 定时任务调度

任务调度：指系统在某个时间执行的特定的命令或程序
例如：1. 系统工作，mysql数据库备份

crontab [选项]	定时任务的设置

| -e   | 编辑crontab定时任务           |
| ---- | ----------------------------- |
| -l   | 查询crontab任务               |
| -r   | 删除当前用户所有的crontab任务 |

crontab -e命令可以编辑调度文件
例如：\*/1 \* \* \* \* ls-l /etc/ > /tmp/to.txt	(*)为占位符

| 项目     | 含义                 | 范围 |
| -------- | -------------------- | ---- |
| 第一个 * | 一小时当中的第几分钟 | 0-59 |
| 第二个 * | 一天当中的第几小时   | 0-23 |
| 第三个 * | 一个月中的第几天     | 1-31 |
| 第四个 * | 一年当中的第几月     | 1-12 |
| 第五个 * | 一周当中的星期几     | 0-7  |

特殊符号：

| 特殊符号 | 含义                                                         |
| -------- | ------------------------------------------------------------ |
| *        | 代表任何时间，比如第一个 “*” 就代变一小时中每分钟都执行一次的意思 |
| ，       | 代表不连续时间。比如“0 8,12,16 * * * 命令”，表示每天 8点0分,12点0分,16点0分执行 |
| -        | 代表连续时间范围。比如"0 5 * * 1-6 命令"，表示周一到周六的凌晨5点0分执行命令 |
| */n      | 代表每隔多久执行一次，比如“*/10 * * * * 命令”，代表每隔10分钟就执行一遍命令 |

service crond restart [重启任务调度]



**at 定时任务**

1. at 命令是一次性定时计划任务，at的守护进程atd会以后台模式运行，检查作业队列来运行。
2. 默认atd每60秒检查作业队列，有作业且作业运行时间与当前时间匹配，则运行
3. at是一次性，执行完后不再执行
4. 使用at一定要保证atd进程的启动

**at命令格式**

at [选项] [时间]   ctrl + D 结束at命令的输入	ps -ef | grep atd 可以检测atd是否在运行

at命令选项:

![](D:\个人资料\Notes\Linux\img\at命令选项.png)

at指定时间的方法：

![](D:\个人资料\Notes\Linux\img\at时间.png)



**atq	**查看当前系统有没有没有执行的工作任务

**atrm 任务编号	**删除任务



### 磁盘分区和挂载

lsblk 或者 lsblk -f	查看设备挂载情况

硬盘说明：
1.Linux硬盘有 IDE 硬盘，SCSI 硬盘，以及还有NVMe

对于IDE硬盘：标识符为 “hdx~”，"hd"表示分区所在设备的类型，"x"为盘好(a为基本盘，b为基本从属盘，c为辅助主盘，d为辅助从属盘)，”~“代表分区，1-4为主区或扩展区，5为逻辑分区

对于SCSI硬盘，标志为"sdx~"，类似上

NBMe是支持固态硬盘，速度快，可参考 https://www.jianshu.com/p/25c9b5149504

fdisk /dev/xxx [xxx为磁盘名] 管理分区

创建完分区后需要格式化：

mkfs -t ext4(文件类型) /dev/xxx [xxx分区名]

讲分区挂载到某个文件夹:

mount /dev/xxx /newdisk/	[xxx为分区名，newdisk为指定文件夹]	挂载

umount	/dev/xxx 或者 /newdisk/	卸载

**命令行挂载，重启会被卸载**

永久挂载 修改文件 /etc/fstab，然后执行 mount -a 执行

df -h	查看磁盘整体使用情况

du -h /目录	查询指定目录的磁盘占用情况，默认为当前目录
-s 指定目录占用大小汇总
-h 带计量单位
-a 含文件
--max-depth = 1 子目录深度
-c 列出明细的同时，增加汇总值

wc -l	列出文件数量

例子：统计/opt文件夹下文件的个数	**ls -l /opt | grep "^-" | wc -l**
			统计/opt文件夹下文件的个换，包括子文件夹	**ls -lR /opt | grep "^- | wc -l"**

tree /目录	以树状结构显示目录



### 网络配置

修改网络ip地址

1. 修改linux网络配置
2. 修改虚拟机网络配置
3. service network restart 重启linux网络服务
4. 如果和主机不在一个网段，需要修改主机的网段

hostname	查看主机名

/etc/hostname	主机名配置文件

/etc/hosts	主机名和ip的映射配置文件
